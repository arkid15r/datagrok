import * as GridUtils from '../utils/GridUtils';
import * as RendUtils from './RendUtils';
import { GridCellRendererEx } from "./GridCellRendererEx";
function isNullText(cell) {
    const bNull = cell === null || cell === undefined || cell.value === null || cell.value === undefined;
    return bNull;
}
export class ClickableTextRenderer extends GridCellRendererEx {
    render(g, nX, nY, nW, nH, cellGrid, style) {
        const cell = cellGrid.cell;
        let str = isNullText(cell) ? null : cell.value.toString();
        if (str === null) {
            return;
        }
        //str = TextUtils.trimText(str, g, nW);
        const strFont = style.font;
        /*
        if (strFont !== null && strFont !== undefined && strFont !== '') {
          g.font = strFont;
        }*/
        RendUtils.renderXYCenteredText(str, g, nX, nY, nW, nH, strFont, 'DodgerBlue');
        /*
        let tm = g.measureText(str);
        const nWLabel = Math.round(tm.width);
        const nYInset = 2;
        tm = g.measureText('W');
        const nAscent = Math.abs(tm.actualBoundingBoxAscent);
        const nDescent = tm.actualBoundingBoxDescent;
        const nHFont : number = nAscent + nDescent + 2 * nYInset;
    
        const nDeltaY : number = Math.floor((nH - nHFont) / 2);
        const nYY = nY + nDeltaY + nHFont;
        g.fillStyle = 'black';
        const strBaseOld = g.textBaseline;
        g.textBaseline = 'top';
        const nXX = nX + ((nW - nWLabel) / 2);
    
        g.textAlign = 'start';
        g.fillStyle = 'DodgerBlue';
        g.fillText(str, nXX, nYY - nHFont + nYInset);
        g.textBaseline = strBaseOld;*/
    }
    isClickable(cellGrid, nXOnCell, nYOnCell) {
        const cell = cellGrid.cell;
        const str = isNullText(cell) ? null : cellGrid.cell.value.toString();
        if (str === null) {
            return false;
        }
        const eCanvas = cellGrid.grid.overlay;
        const g = eCanvas.getContext('2d');
        if (g === null) {
            return false;
        }
        const strFont = cellGrid.style.font;
        if (strFont !== null && strFont !== undefined && strFont !== '') {
            g.font = strFont;
        }
        let tm = g.measureText(str);
        const nWLabel = Math.round(tm.width);
        const nYInset = 2;
        tm = g.measureText('W');
        const nAscent = Math.abs(tm.actualBoundingBoxAscent);
        const nDescent = tm.actualBoundingBoxDescent;
        const nHFont = nAscent + nDescent + 2 * nYInset;
        const nHRow = GridUtils.getGridRowHeight(cellGrid.grid);
        const nDeltaY = Math.floor((nHRow - nHFont) / 2);
        const nXX = 0 + ((cellGrid.gridColumn.width - nWLabel) / 2);
        const bX = nXX <= 0 || (nXOnCell >= nXX && nXOnCell <= nXX + nWLabel);
        if (!bX) {
            return false;
        }
        const bY = nDeltaY < 0 || (nYOnCell >= nDeltaY && nYOnCell <= nDeltaY + nHFont);
        return bY;
    }
    onMouseUpEx(cellGrid, e, nXOnCell, nYOnCell) {
        if (document.body.style.cursor !== 'auto') {
            document.body.style.cursor = 'auto';
        }
    }
    onMouseMoveEx(cellGrid, e, nXOnCell, nYOnCell) {
        //console.log('Move');
        if (e.buttons !== 0) {
            return;
        }
        const b = this.isClickable(cellGrid, nXOnCell, nYOnCell);
        if (b) {
            if (document.body.style.cursor !== 'pointer') {
                document.body.style.cursor = 'pointer';
            }
        }
        else {
            if (document.body.style.cursor !== 'auto') {
                document.body.style.cursor = 'auto';
            }
        }
        //this.onMouseMove(cellGrid, e);
    }
    onMouseLeaveEx(cellGrid, e, nXOnCell, nYOnCell) {
        //console.log('Out');
        document.body.style.cursor = 'auto';
        //this.onMouseLeave(cellGrid, e);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2xpY2thYmxlVGV4dFJlbmRlcmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ2xpY2thYmxlVGV4dFJlbmRlcmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sS0FBSyxTQUFTLE1BQU0sb0JBQW9CLENBQUM7QUFDaEQsT0FBTyxLQUFLLFNBQVMsTUFBTSxhQUFhLENBQUM7QUFDekMsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFFeEQsU0FBUyxVQUFVLENBQUMsSUFBYztJQUNoQyxNQUFNLEtBQUssR0FBYSxJQUFJLEtBQUssSUFBSSxJQUFJLElBQUksS0FBSyxTQUFTLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUM7SUFDL0csT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRUQsTUFBTSxPQUFPLHFCQUFzQixTQUFRLGtCQUFrQjtJQUUzRCxNQUFNLENBQUMsQ0FBNEIsRUFBRSxFQUFXLEVBQUUsRUFBVyxFQUFFLEVBQVcsRUFBRSxFQUFXLEVBQUUsUUFBc0IsRUFBRSxLQUF3QjtRQUN2SSxNQUFNLElBQUksR0FBYSxRQUFRLENBQUMsSUFBSSxDQUFDO1FBQ3JDLElBQUksR0FBRyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzFELElBQUksR0FBRyxLQUFLLElBQUksRUFBRTtZQUNoQixPQUFPO1NBQ1I7UUFFRCx1Q0FBdUM7UUFDdkMsTUFBTSxPQUFPLEdBQWEsS0FBSyxDQUFDLElBQUksQ0FBQztRQUNyQzs7O1dBR0c7UUFDSCxTQUFTLENBQUMsb0JBQW9CLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFF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Q3hGLHNCQUFzQjtRQUV0QixJQUFHLENBQUMsQ0FBQyxPQUFPLEtBQUssQ0FBQyxFQUFFO1lBQ2xCLE9BQU87U0FDUjtRQUVELE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUN6RCxJQUFJLENBQUMsRUFBRTtZQUNMLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLFNBQVMsRUFBRTtnQkFDNUMsUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQzthQUN4QztTQUNGO2FBQU07WUFDTCxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxNQUFNLEVBQUU7Z0JBQ3pDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7YUFDckM7U0FDRjtRQUNELGdDQUFnQztJQUNsQyxDQUFDO0lBR0QsY0FBYyxDQUFDLFFBQXNCLEVBQUUsQ0FBYyxFQUFFLFFBQWlCLEVBQUUsUUFBaUI7UUFDekYscUJBQXFCO1FBQ3JCLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDcEMsaUNBQWlDO0lBQ25DLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIERHIGZyb20gJ2RhdGFncm9rLWFwaS9kZyc7XHJcbmltcG9ydCAqIGFzIEdyaWRVdGlscyBmcm9tICcuLi91dGlscy9HcmlkVXRpbHMnO1xyXG5pbXBvcnQgKiBhcyBSZW5kVXRpbHMgZnJvbSAnLi9SZW5kVXRpbHMnO1xyXG5pbXBvcnQge0dyaWRDZWxsUmVuZGVyZXJFeH0gZnJvbSBcIi4vR3JpZENlbGxSZW5kZXJlckV4XCI7XHJcblxyXG5mdW5jdGlvbiBpc051bGxUZXh0KGNlbGwgOiBERy5DZWxsKSA6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IGJOdWxsIDogYm9vbGVhbiA9IGNlbGwgPT09IG51bGwgfHwgY2VsbCA9PT0gdW5kZWZpbmVkIHx8IGNlbGwudmFsdWUgPT09IG51bGwgfHwgY2VsbC52YWx1ZSA9PT0gdW5kZWZpbmVkO1xyXG4gIHJldHVybiBiTnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENsaWNrYWJsZVRleHRSZW5kZXJlciBleHRlbmRzIEdyaWRDZWxsUmVuZGVyZXJFeCB7XHJcblxyXG4gIHJlbmRlcihnIDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBuWCA6IG51bWJlciwgblkgOiBudW1iZXIsIG5XIDogbnVtYmVyLCBuSCA6IG51bWJlciwgY2VsbEdyaWQgOiBERy5HcmlkQ2VsbCwgc3R5bGUgOiBERy5HcmlkQ2VsbFN0eWxlKSA6IHZvaWQge1xyXG4gICAgY29uc3QgY2VsbCA6IERHLkNlbGwgPSBjZWxsR3JpZC5jZWxsO1xyXG4gICAgbGV0IHN0ciA9IGlzTnVsbFRleHQoY2VsbCkgPyBudWxsIDogY2VsbC52YWx1ZS50b1N0cmluZygpO1xyXG4gICAgaWYgKHN0ciA9PT0gbnVsbCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy9zdHIgPSBUZXh0VXRpbHMudHJpbVRleHQoc3RyLCBnLCBuVyk7XHJcbiAgICBjb25zdCBzdHJGb250IDogc3RyaW5nICA9IHN0eWxlLmZvbnQ7XHJcbiAgICAvKlxyXG4gICAgaWYgKHN0ckZvbnQgIT09IG51bGwgJiYgc3RyRm9udCAhPT0gdW5kZWZpbmVkICYmIHN0ckZvbnQgIT09ICcnKSB7XHJcbiAgICAgIGcuZm9udCA9IHN0ckZvbnQ7XHJcbiAgICB9Ki9cclxuICAgIFJlbmRVdGlscy5yZW5kZXJYWUNlbnRlcmVkVGV4dChzdHIsIGcsIG5YLCBuWSwgblcsIG5ILCBzdHJGb250LCAnRG9kZ2VyQmx1ZScpO1xyXG4gICAgLypcclxuICAgIGxldCB0bSA9IGcubWVhc3VyZVRleHQoc3RyKTtcclxuICAgIGNvbnN0IG5XTGFiZWwgPSBNYXRoLnJvdW5kKHRtLndpZHRoKTtcclxuICAgIGNvbnN0IG5ZSW5zZXQgPSAyO1xyXG4gICAgdG0gPSBnLm1lYXN1cmVUZXh0KCdXJyk7XHJcbiAgICBjb25zdCBuQXNjZW50ID0gTWF0aC5hYnModG0uYWN0dWFsQm91bmRpbmdCb3hBc2NlbnQpO1xyXG4gICAgY29uc3QgbkRlc2NlbnQgPSB0bS5hY3R1YWxCb3VuZGluZ0JveERlc2NlbnQ7XHJcbiAgICBjb25zdCBuSEZvbnQgOiBudW1iZXIgPSBuQXNjZW50ICsgbkRlc2NlbnQgKyAyICogbllJbnNldDtcclxuXHJcbiAgICBjb25zdCBuRGVsdGFZIDogbnVtYmVyID0gTWF0aC5mbG9vcigobkggLSBuSEZvbnQpIC8gMik7XHJcbiAgICBjb25zdCBuWVkgPSBuWSArIG5EZWx0YVkgKyBuSEZvbnQ7XHJcbiAgICBnLmZpbGxTdHlsZSA9ICdibGFjayc7XHJcbiAgICBjb25zdCBzdHJCYXNlT2xkID0gZy50ZXh0QmFzZWxpbmU7XHJcbiAgICBnLnRleHRCYXNlbGluZSA9ICd0b3AnO1xyXG4gICAgY29uc3QgblhYID0gblggKyAoKG5XIC0gbldMYWJlbCkgLyAyKTtcclxuXHJcbiAgICBnLnRleHRBbGlnbiA9ICdzdGFydCc7XHJcbiAgICBnLmZpbGxTdHlsZSA9ICdEb2RnZXJCbHVlJztcclxuICAgIGcuZmlsbFRleHQoc3RyLCBuWFgsIG5ZWSAtIG5IRm9udCArIG5ZSW5zZXQpO1xyXG4gICAgZy50ZXh0QmFzZWxpbmUgPSBzdHJCYXNlT2xkOyovXHJcbiAgfVxyXG5cclxuICBpc0NsaWNrYWJsZShjZWxsR3JpZCA6IERHLkdyaWRDZWxsLCBuWE9uQ2VsbCA6IG51bWJlciwgbllPbkNlbGwgOiBudW1iZXIpIDogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBjZWxsIDogREcuQ2VsbCA9IGNlbGxHcmlkLmNlbGw7XHJcbiAgICBjb25zdCBzdHIgOiBzdHJpbmcgPSBpc051bGxUZXh0KGNlbGwpID8gbnVsbCA6IGNlbGxHcmlkLmNlbGwudmFsdWUudG9TdHJpbmcoKTtcclxuICAgIGlmIChzdHIgPT09IG51bGwpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZUNhbnZhcyA9IGNlbGxHcmlkLmdyaWQub3ZlcmxheTtcclxuICAgIGNvbnN0IGcgPSBlQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICBpZihnID09PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzdHJGb250IDogc3RyaW5nICA9IGNlbGxHcmlkLnN0eWxlLmZvbnQ7XHJcbiAgICBpZiAoc3RyRm9udCAhPT0gbnVsbCAmJiBzdHJGb250ICE9PSB1bmRlZmluZWQgJiYgc3RyRm9udCAhPT0gJycpIHtcclxuICAgICAgZy5mb250ID0gc3RyRm9udDtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgdG0gPSBnLm1lYXN1cmVUZXh0KHN0cik7XHJcbiAgICBjb25zdCBuV0xhYmVsID0gTWF0aC5yb3VuZCh0bS53aWR0aCk7XHJcbiAgICBjb25zdCBuWUluc2V0ID0gMjtcclxuICAgIHRtID0gZy5tZWFzdXJlVGV4dCgnVycpO1xyXG4gICAgY29uc3QgbkFzY2VudCA9IE1hdGguYWJzKHRtLmFjdHVhbEJvdW5kaW5nQm94QXNjZW50KTtcclxuICAgIGNvbnN0IG5EZXNjZW50ID0gdG0uYWN0dWFsQm91bmRpbmdCb3hEZXNjZW50O1xyXG4gICAgY29uc3QgbkhGb250ID0gbkFzY2VudCArIG5EZXNjZW50ICsgMiAqIG5ZSW5zZXQ7XHJcblxyXG4gICAgY29uc3QgbkhSb3cgPSBHcmlkVXRpbHMuZ2V0R3JpZFJvd0hlaWdodChjZWxsR3JpZC5ncmlkKTtcclxuICAgIGNvbnN0IG5EZWx0YVkgPSBNYXRoLmZsb29yKChuSFJvdyAtIG5IRm9udCkgLyAyKTtcclxuICAgIGNvbnN0IG5YWCA9IDAgKyAoKGNlbGxHcmlkLmdyaWRDb2x1bW4ud2lkdGggLSBuV0xhYmVsKSAvIDIpO1xyXG4gICAgY29uc3QgYlggPSBuWFggPD0gMCB8fCAoblhPbkNlbGwgPj0gblhYICYmIG5YT25DZWxsIDw9IG5YWCArIG5XTGFiZWwpO1xyXG4gICAgaWYgKCFiWCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBjb25zdCBiWSA9IG5EZWx0YVkgPCAwIHx8IChuWU9uQ2VsbCA+PSBuRGVsdGFZICYmIG5ZT25DZWxsIDw9IG5EZWx0YVkgKyBuSEZvbnQpO1xyXG4gICAgcmV0dXJuIGJZO1xyXG4gIH1cclxuXHJcblxyXG4gIG9uTW91c2VVcEV4KGNlbGxHcmlkIDogREcuR3JpZENlbGwsIGUgOiBNb3VzZUV2ZW50LCBuWE9uQ2VsbCA6IG51bWJlciwgbllPbkNlbGwgOiBudW1iZXIpIDogdm9pZCB7XHJcbiAgICBpZiAoZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgIT09ICdhdXRvJykge1xyXG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdhdXRvJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uTW91c2VNb3ZlRXgoY2VsbEdyaWQgOiBERy5HcmlkQ2VsbCwgZSA6IE1vdXNlRXZlbnQsIG5YT25DZWxsIDogbnVtYmVyLCBuWU9uQ2VsbCA6IG51bWJlcikgOiB2b2lkIHtcclxuICAgIC8vY29uc29sZS5sb2coJ01vdmUnKTtcclxuXHJcbiAgICBpZihlLmJ1dHRvbnMgIT09IDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGIgPSB0aGlzLmlzQ2xpY2thYmxlKGNlbGxHcmlkLCBuWE9uQ2VsbCwgbllPbkNlbGwpO1xyXG4gICAgaWYgKGIpIHtcclxuICAgICAgaWYgKGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yICE9PSAncG9pbnRlcicpIHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yICE9PSAnYXV0bycpIHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdhdXRvJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy90aGlzLm9uTW91c2VNb3ZlKGNlbGxHcmlkLCBlKTtcclxuICB9XHJcblxyXG5cclxuICBvbk1vdXNlTGVhdmVFeChjZWxsR3JpZCA6IERHLkdyaWRDZWxsLCBlIDogTW91c2VFdmVudCwgblhPbkNlbGwgOiBudW1iZXIsIG5ZT25DZWxsIDogbnVtYmVyKSA6IHZvaWQge1xyXG4gICAgLy9jb25zb2xlLmxvZygnT3V0Jyk7XHJcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdhdXRvJztcclxuICAgIC8vdGhpcy5vbk1vdXNlTGVhdmUoY2VsbEdyaWQsIGUpO1xyXG4gIH1cclxufVxyXG4iXX0=
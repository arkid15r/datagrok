#name: RemoveSpikes
#description: Remove spikes of specified parameters
#language: python
#tags: biosignals, filters, pyphysio
#input: dataframe dataframe
#input: column column
#input: double sampling_frequency
#input: double K = 2
#input: double N = 1
#input: double dilate = 0
#input: double D = 0.95
#input: string method {choices: ['linear', 'step']}
#output: dataframe df

import pyphysio as ph

sig = ph.EvenlySignal(values=dataframe[column], sampling_freq=sampling_frequency)

sig = ph.RemoveSpikes(K=K, N=N, dilate=dilate, D=D, method=method)(sig)

df = pd.DataFrame({
    'time': range(len(sig)),
    'sig': sig
})